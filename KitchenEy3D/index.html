<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>3D Restaurant Simulation</title>
  <style>
    body { margin: 0; overflow: hidden; }
  </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script src="objects3d.js"></script>
<script src="functions3d.js"></script>

<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.set(0, 120, 160);
camera.lookAt(0, 0, 0);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Light
scene.add(new THREE.AmbientLight(0xffffff, 0.6));
const dir = new THREE.DirectionalLight(0xffffff, 0.8);
dir.position.set(50, 100, 50);
scene.add(dir);

// Floor
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(400, 300),
  new THREE.MeshStandardMaterial({ color: 0x222222 })
);
floor.rotation.x = -Math.PI / 2;
scene.add(floor);

// Kitchen
const kitchen = new Kitchen3D(scene, 0, 0, -120);

// Tables
const tables = [];
let id = 0;
for (let z = -40; z <= 80; z += 40) {
  for (let x = -120; x <= 120; x += 40) {
    tables.push(new Table3D(scene, id++, x, z));
  }
}

// Waiters
const waiters = [];
for (let i = 0; i < 6; i++) {
  waiters.push(new Waiter3D(scene, i, -160, -40 + i * 20));
}

let last = performance.now();
function animate(now) {
  const dt = (now - last) / 1000;
  last = now;

  tables.forEach(t => t.update(dt));
  assignTasks3D(waiters, tables, kitchen);

  waiters.forEach(w => w.move(dt, tables, waiters));

  renderer.render(scene, camera);
  requestAnimationFrame(animate);
}

requestAnimationFrame(animate);
</script>
</body>
</html>
